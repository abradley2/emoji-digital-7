(()=>{var replicateFill=function(count){return function(value2){if(count<1){return[]}var result=new Array(count);return result.fill(value2)}};var replicatePolyfill=function(count){return function(value2){var result=[];var n=0;for(var i=0;i<count;i++){result[n++]=value2}return result}};var replicate=typeof Array.prototype.fill==="function"?replicateFill:replicatePolyfill;var fromFoldableImpl=function(){function Cons3(head3,tail2){this.head=head3;this.tail=tail2}var emptyList={};function curryCons(head3){return function(tail2){return new Cons3(head3,tail2)}}function listToArray(list){var result=[];var count=0;var xs=list;while(xs!==emptyList){result[count++]=xs.head;xs=xs.tail}return result}return function(foldr3){return function(xs){return listToArray(foldr3(curryCons)(emptyList)(xs))}}}();var length=function(xs){return xs.length};var filter=function(f){return function(xs){return xs.filter(f)}};var sortByImpl=function(){function mergeFromTo(compare2,fromOrdering,xs1,xs2,from3,to3){var mid;var i;var j;var k;var x;var y;var c;mid=from3+(to3-from3>>1);if(mid-from3>1)mergeFromTo(compare2,fromOrdering,xs2,xs1,from3,mid);if(to3-mid>1)mergeFromTo(compare2,fromOrdering,xs2,xs1,mid,to3);i=from3;j=mid;k=from3;while(i<mid&&j<to3){x=xs2[i];y=xs2[j];c=fromOrdering(compare2(x)(y));if(c>0){xs1[k++]=y;++j}else{xs1[k++]=x;++i}}while(i<mid){xs1[k++]=xs2[i++]}while(j<to3){xs1[k++]=xs2[j++]}}return function(compare2){return function(fromOrdering){return function(xs){var out;if(xs.length<2)return xs;out=xs.slice(0);mergeFromTo(compare2,fromOrdering,out,xs.slice(0),0,xs.length);return out}}}}();var unsafeIndexImpl=function(xs){return function(n){return xs[n]}};var arrayMap=function(f){return function(arr){var l=arr.length;var result=new Array(l);for(var i=0;i<l;i++){result[i]=f(arr[i])}return result}};var semigroupoidFn={compose:function(f){return function(g){return function(x){return f(g(x))}}}};var identity=function(dict){return dict.identity};var categoryFn={identity:function(x){return x},Semigroupoid0:function(){return semigroupoidFn}};var otherwise=true;var flip=function(f){return function(b){return function(a){return f(a)(b)}}};var $$const=function(a){return function(v){return a}};var unit=void 0;var showUnit={show:function(v){return"unit"}};var map=function(dict){return dict.map};var $$void=function(dictFunctor){return map(dictFunctor)($$const(unit))};var functorArray={map:arrayMap};var concatString=function(s1){return function(s2){return s1+s2}};var concatArray=function(xs){return function(ys){if(xs.length===0)return ys;if(ys.length===0)return xs;return xs.concat(ys)}};var semigroupString={append:concatString};var semigroupArray={append:concatArray};var append=function(dict){return dict.append};var arrayApply=function(fs){return function(xs){var l=fs.length;var k=xs.length;var result=new Array(l*k);var n=0;for(var i=0;i<l;i++){var f=fs[i];for(var j=0;j<k;j++){result[n++]=f(xs[j])}}return result}};var identity2=identity(categoryFn);var applyArray={apply:arrayApply,Functor0:function(){return functorArray}};var apply=function(dict){return dict.apply};var applySecond=function(dictApply){var apply1=apply(dictApply);var map6=map(dictApply.Functor0());return function(a){return function(b){return apply1(map6($$const(identity2))(a))(b)}}};var pure=function(dict){return dict.pure};var when=function(dictApplicative){var pure1=pure(dictApplicative);return function(v){return function(v1){if(v){return v1}if(!v){return pure1(unit)}throw new Error("Failed pattern match at Control.Applicative (line 63, column 1 - line 63, column 63): "+[v.constructor.name,v1.constructor.name])}}};var liftA1=function(dictApplicative){var apply2=apply(dictApplicative.Apply0());var pure1=pure(dictApplicative);return function(f){return function(a){return apply2(pure1(f))(a)}}};var arrayBind=function(arr){return function(f){var result=[];for(var i=0,l=arr.length;i<l;i++){Array.prototype.push.apply(result,f(arr[i]))}return result}};var bindArray={bind:arrayBind,Apply0:function(){return applyArray}};var bind=function(dict){return dict.bind};var bindFlipped=function(dictBind){return flip(bind(dictBind))};var ap=function(dictMonad){var bind3=bind(dictMonad.Bind1());var pure4=pure(dictMonad.Applicative0());return function(f){return function(a){return bind3(f)(function(f$prime){return bind3(a)(function(a$prime){return pure4(f$prime(a$prime))})})}}};var topInt=2147483647;var bottomInt=-2147483648;var topChar=String.fromCharCode(65535);var bottomChar=String.fromCharCode(0);var topNumber=Number.POSITIVE_INFINITY;var bottomNumber=Number.NEGATIVE_INFINITY;var unsafeCompareImpl=function(lt){return function(eq3){return function(gt){return function(x){return function(y){return x<y?lt:x===y?eq3:gt}}}}};var ordIntImpl=unsafeCompareImpl;var ordCharImpl=unsafeCompareImpl;var refEq=function(r1){return function(r2){return r1===r2}};var eqIntImpl=refEq;var eqCharImpl=refEq;var eqStringImpl=refEq;var eqString={eq:eqStringImpl};var eqInt={eq:eqIntImpl};var eqChar={eq:eqCharImpl};var eq1=function(dict){return dict.eq1};var eq=function(dict){return dict.eq};var LT=function(){function LT2(){}LT2.value=new LT2;return LT2}();var GT=function(){function GT2(){}GT2.value=new GT2;return GT2}();var EQ=function(){function EQ2(){}EQ2.value=new EQ2;return EQ2}();var intSub=function(x){return function(y){return x-y|0}};var intAdd=function(x){return function(y){return x+y|0}};var intMul=function(x){return function(y){return x*y|0}};var semiringInt={add:intAdd,zero:0,mul:intMul,one:1};var ringInt={sub:intSub,Semiring0:function(){return semiringInt}};var ordInt=function(){return{compare:ordIntImpl(LT.value)(EQ.value)(GT.value),Eq0:function(){return eqInt}}}();var ordChar=function(){return{compare:ordCharImpl(LT.value)(EQ.value)(GT.value),Eq0:function(){return eqChar}}}();var top=function(dict){return dict.top};var boundedInt={top:topInt,bottom:bottomInt,Ord0:function(){return ordInt}};var boundedChar={top:topChar,bottom:bottomChar,Ord0:function(){return ordChar}};var bottom=function(dict){return dict.bottom};var showStringImpl=function(s){var l=s.length;return'"'+s.replace(/[\0-\x1F\x7F"\\]/g,function(c,i){switch(c){case'"':case"\\":return"\\"+c;case"":return"\\a";case"\b":return"\\b";case"\f":return"\\f";case"\n":return"\\n";case"\r":return"\\r";case"\t":return"\\t";case"\v":return"\\v"}var k=i+1;var empty4=k<l&&s[k]>="0"&&s[k]<="9"?"\\&":"";return"\\"+c.charCodeAt(0).toString(10)+empty4})+'"'};var showString={show:showStringImpl};var show=function(dict){return dict.show};var Nothing=function(){function Nothing2(){}Nothing2.value=new Nothing2;return Nothing2}();var Just=function(){function Just2(value0){this.value0=value0}Just2.create=function(value0){return new Just2(value0)};return Just2}();var functorMaybe={map:function(v){return function(v1){if(v1 instanceof Just){return new Just(v(v1.value0))}return Nothing.value}}};var fromJust=function(){return function(v){if(v instanceof Just){return v.value0}throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[v.constructor.name])}};var Left=function(){function Left2(value0){this.value0=value0}Left2.create=function(value0){return new Left2(value0)};return Left2}();var Right=function(){function Right2(value0){this.value0=value0}Right2.create=function(value0){return new Right2(value0)};return Right2}();var intDegree=function(x){return Math.min(Math.abs(x),2147483647)};var intDiv=function(x){return function(y){if(y===0)return 0;return y>0?Math.floor(x/y):-Math.floor(x/-y)}};var intMod=function(x){return function(y){if(y===0)return 0;var yy=Math.abs(y);return(x%yy+yy)%yy}};var commutativeRingInt={Ring0:function(){return ringInt}};var mod=function(dict){return dict.mod};var euclideanRingInt={degree:intDegree,div:intDiv,mod:intMod,CommutativeRing0:function(){return commutativeRingInt}};var div=function(dict){return dict.div};var monoidString={mempty:"",Semigroup0:function(){return semigroupString}};var monoidArray={mempty:[],Semigroup0:function(){return semigroupArray}};var mempty=function(dict){return dict.mempty};var pureE=function(a){return function(){return a}};var bindE=function(a){return function(f){return function(){return f(a())()}}};var $runtime_lazy=function(name2,moduleName,init4){var state2=0;var val;return function(lineNumber){if(state2===2)return val;if(state2===1)throw new ReferenceError(name2+" was needed before it finished initializing (module "+moduleName+", line "+lineNumber+")",moduleName,lineNumber);state2=1;val=init4();state2=2;return val}};var monadEffect={Applicative0:function(){return applicativeEffect},Bind1:function(){return bindEffect}};var bindEffect={bind:bindE,Apply0:function(){return $lazy_applyEffect(0)}};var applicativeEffect={pure:pureE,Apply0:function(){return $lazy_applyEffect(0)}};var $lazy_functorEffect=$runtime_lazy("functorEffect","Effect",function(){return{map:liftA1(applicativeEffect)}});var $lazy_applyEffect=$runtime_lazy("applyEffect","Effect",function(){return{apply:ap(monadEffect),Functor0:function(){return $lazy_functorEffect(0)}}});var functorEffect=$lazy_functorEffect(20);var _new=function(val){return function(){return{value:val}}};var read=function(ref){return function(){return ref.value}};var write=function(val){return function(ref){return function(){ref.value=val}}};var $$new=_new;var map_=function(f){return function(a){return function(){return f(a())}}};var pure_=function(a){return function(){return a}};var bind_=function(a){return function(f){return function(){return f(a())()}}};function forST(lo){return function(hi){return function(f){return function(){for(var i=lo;i<hi;i++){f(i)()}}}}}var $runtime_lazy2=function(name2,moduleName,init4){var state2=0;var val;return function(lineNumber){if(state2===2)return val;if(state2===1)throw new ReferenceError(name2+" was needed before it finished initializing (module "+moduleName+", line "+lineNumber+")",moduleName,lineNumber);state2=1;val=init4();state2=2;return val}};var functorST={map:map_};var monadST={Applicative0:function(){return applicativeST},Bind1:function(){return bindST}};var bindST={bind:bind_,Apply0:function(){return $lazy_applyST(0)}};var applicativeST={pure:pure_,Apply0:function(){return $lazy_applyST(0)}};var $lazy_applyST=$runtime_lazy2("applyST","Control.Monad.ST.Internal",function(){return{apply:ap(monadST),Functor0:function(){return functorST}}});function newSTArray(){return[]}var pushAll=function(as){return function(xs){return function(){return xs.push.apply(xs,as)}}};var unsafeFreeze=function(xs){return function(){return xs}};var sortByImpl2=function(){function mergeFromTo(compare2,fromOrdering,xs1,xs2,from3,to3){var mid;var i;var j;var k;var x;var y;var c;mid=from3+(to3-from3>>1);if(mid-from3>1)mergeFromTo(compare2,fromOrdering,xs2,xs1,from3,mid);if(to3-mid>1)mergeFromTo(compare2,fromOrdering,xs2,xs1,mid,to3);i=from3;j=mid;k=from3;while(i<mid&&j<to3){x=xs2[i];y=xs2[j];c=fromOrdering(compare2(x)(y));if(c>0){xs1[k++]=y;++j}else{xs1[k++]=x;++i}}while(i<mid){xs1[k++]=xs2[i++]}while(j<to3){xs1[k++]=xs2[j++]}}return function(compare2){return function(fromOrdering){return function(xs){return function(){if(xs.length<2)return xs;mergeFromTo(compare2,fromOrdering,xs,xs.slice(0),0,xs.length);return xs}}}}}();var bind2=bind(bindST);var run2=function(st){return bind2(st)(unsafeFreeze)()};var push=function(a){return pushAll([a])};var boolConj=function(b1){return function(b2){return b1&&b2}};var boolDisj=function(b1){return function(b2){return b1||b2}};var boolNot=function(b){return!b};var not=function(dict){return dict.not};var disj=function(dict){return dict.disj};var heytingAlgebraBoolean={ff:false,tt:true,implies:function(a){return function(b){return disj(heytingAlgebraBoolean)(not(heytingAlgebraBoolean)(a))(b)}},conj:boolConj,disj:boolDisj,not:boolNot};var foldrArray=function(f){return function(init4){return function(xs){var acc=init4;var len=xs.length;for(var i=len-1;i>=0;i--){acc=f(xs[i])(acc)}return acc}}};var foldlArray=function(f){return function(init4){return function(xs){var acc=init4;var len=xs.length;for(var i=0;i<len;i++){acc=f(acc)(xs[i])}return acc}}};var Tuple=function(){function Tuple2(value0,value1){this.value0=value0;this.value1=value1}Tuple2.create=function(value0){return function(value1){return new Tuple2(value0,value1)}};return Tuple2}();var unsafeCoerce2=function(x){return x};var coerce=function(){return unsafeCoerce2};var coerce2=coerce();var wrap=function(){return coerce2};var unwrap=function(){return coerce2};var identity3=identity(categoryFn);var foldr=function(dict){return dict.foldr};var traverse_=function(dictApplicative){var applySecond2=applySecond(dictApplicative.Apply0());var pure4=pure(dictApplicative);return function(dictFoldable){var foldr22=foldr(dictFoldable);return function(f){return foldr22(function($449){return applySecond2(f($449))})(pure4(unit))}}};var for_=function(dictApplicative){var traverse_1=traverse_(dictApplicative);return function(dictFoldable){return flip(traverse_1(dictFoldable))}};var foldl=function(dict){return dict.foldl};var foldMapDefaultR=function(dictFoldable){var foldr22=foldr(dictFoldable);return function(dictMonoid){var append3=append(dictMonoid.Semigroup0());var mempty3=mempty(dictMonoid);return function(f){return foldr22(function(x){return function(acc){return append3(f(x))(acc)}})(mempty3)}}};var foldableArray={foldr:foldrArray,foldl:foldlArray,foldMap:function(dictMonoid){return foldMapDefaultR(foldableArray)(dictMonoid)}};var foldMap=function(dict){return dict.foldMap};var fold=function(dictFoldable){var foldMap2=foldMap(dictFoldable);return function(dictMonoid){return foldMap2(dictMonoid)(identity3)}};var traverseArrayImpl=function(){function array1(a){return[a]}function array2(a){return function(b){return[a,b]}}function array3(a){return function(b){return function(c){return[a,b,c]}}}function concat2(xs){return function(ys){return xs.concat(ys)}}return function(apply2){return function(map6){return function(pure4){return function(f){return function(array){function go(bot,top3){switch(top3-bot){case 0:return pure4([]);case 1:return map6(array1)(f(array[bot]));case 2:return apply2(map6(array2)(f(array[bot])))(f(array[bot+1]));case 3:return apply2(apply2(map6(array3)(f(array[bot])))(f(array[bot+1])))(f(array[bot+2]));default:var pivot=bot+Math.floor((top3-bot)/4)*2;return apply2(map6(concat2)(go(bot,pivot)))(go(pivot,top3))}}return go(0,array.length)}}}}}}();var $$void2=$$void(functorST);var fold1=fold(foldableArray);var unsafeIndex=function(){return unsafeIndexImpl};var unsafeIndex1=unsafeIndex();var singleton2=function(a){return[a]};var intersperse=function(a){return function(arr){var v=length(arr);if(v<2){return arr}if(otherwise){return run2(function(){var unsafeGetElem=function(idx){return unsafeIndex1(arr)(idx)};return function __do(){var out=newSTArray();push(unsafeGetElem(0))(out)();forST(1)(v)(function(idx){return function __do2(){push(a)(out)();return $$void2(push(unsafeGetElem(idx))(out))()}})();return out}}())}throw new Error("Failed pattern match at Data.Array (line 611, column 21 - line 620, column 19): "+[v.constructor.name])}};var fromFoldable=function(dictFoldable){return fromFoldableImpl(foldr(dictFoldable))};var foldl2=foldl(foldableArray);var fold2=function(dictMonoid){return fold1(dictMonoid)};var concatMap=flip(bind(bindArray));var Nil=function(){function Nil3(){}Nil3.value=new Nil3;return Nil3}();var Cons=function(){function Cons3(value0,value1){this.value0=value0;this.value1=value1}Cons3.create=function(value0){return function(value1){return new Cons3(value0,value1)}};return Cons3}();var foldableList={foldr:function(f){return function(b){var rev=function(){var go=function($copy_acc){return function($copy_v){var $tco_var_acc=$copy_acc;var $tco_done=false;var $tco_result;function $tco_loop(acc,v){if(v instanceof Nil){$tco_done=true;return acc}if(v instanceof Cons){$tco_var_acc=new Cons(v.value0,acc);$copy_v=v.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 107, column 7 - line 107, column 23): "+[acc.constructor.name,v.constructor.name])}while(!$tco_done){$tco_result=$tco_loop($tco_var_acc,$copy_v)}return $tco_result}};return go(Nil.value)}();var $281=foldl(foldableList)(flip(f))(b);return function($282){return $281(rev($282))}}},foldl:function(f){var go=function($copy_b){return function($copy_v){var $tco_var_b=$copy_b;var $tco_done1=false;var $tco_result;function $tco_loop(b,v){if(v instanceof Nil){$tco_done1=true;return b}if(v instanceof Cons){$tco_var_b=f(b)(v.value0);$copy_v=v.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 111, column 12 - line 113, column 30): "+[v.constructor.name])}while(!$tco_done1){$tco_result=$tco_loop($tco_var_b,$copy_v)}return $tco_result}};return go},foldMap:function(dictMonoid){var append22=append(dictMonoid.Semigroup0());var mempty3=mempty(dictMonoid);return function(f){return foldl(foldableList)(function(acc){var $283=append22(acc);return function($284){return $283(f($284))}})(mempty3)}}};var foldr2=foldr(foldableList);var semigroupList={append:function(xs){return function(ys){return foldr2(Cons.create)(ys)(xs)}}};var eq1List={eq1:function(dictEq){var eq3=eq(dictEq);return function(xs){return function(ys){var go=function($copy_v){return function($copy_v1){return function($copy_v2){var $tco_var_v=$copy_v;var $tco_var_v1=$copy_v1;var $tco_done=false;var $tco_result;function $tco_loop(v,v1,v2){if(!v2){$tco_done=true;return false}if(v instanceof Nil&&v1 instanceof Nil){$tco_done=true;return v2}if(v instanceof Cons&&v1 instanceof Cons){$tco_var_v=v.value1;$tco_var_v1=v1.value1;$copy_v2=v2&&eq3(v1.value0)(v.value0);return}$tco_done=true;return false}while(!$tco_done){$tco_result=$tco_loop($tco_var_v,$tco_var_v1,$copy_v2)}return $tco_result}}};return go(xs)(ys)(true)}}}};var eq12=eq1(eq1List);var eqList=function(dictEq){return{eq:eq12(dictEq)}};var fromFoldable2=function(dictFoldable){return foldr(dictFoldable)(Cons.create)(Nil.value)};var split=function(sep){return function(s){return s.split(sep)}};var toLower=function(s){return s.toLowerCase()};var toUpper=function(s){return s.toUpperCase()};var $$null=function(s){return s===""};var Aff=function(){var EMPTY={};var PURE="Pure";var THROW="Throw";var CATCH="Catch";var SYNC="Sync";var ASYNC="Async";var BIND="Bind";var BRACKET="Bracket";var FORK="Fork";var SEQ="Sequential";var MAP="Map";var APPLY="Apply";var ALT="Alt";var CONS="Cons";var RESUME="Resume";var RELEASE="Release";var FINALIZER="Finalizer";var FINALIZED="Finalized";var FORKED="Forked";var FIBER="Fiber";var THUNK="Thunk";function Aff2(tag,_1,_2,_3){this.tag=tag;this._1=_1;this._2=_2;this._3=_3}function AffCtr(tag){var fn=function(_1,_2,_3){return new Aff2(tag,_1,_2,_3)};fn.tag=tag;return fn}function nonCanceler(error3){return new Aff2(PURE,void 0)}function runEff(eff){try{eff()}catch(error3){setTimeout(function(){throw error3},0)}}function runSync(left,right,eff){try{return right(eff())}catch(error3){return left(error3)}}function runAsync(left,eff,k){try{return eff(k)()}catch(error3){k(left(error3))();return nonCanceler}}var Scheduler=function(){var limit=1024;var size3=0;var ix=0;var queue=new Array(limit);var draining=false;function drain(){var thunk;draining=true;while(size3!==0){size3--;thunk=queue[ix];queue[ix]=void 0;ix=(ix+1)%limit;thunk()}draining=false}return{isDraining:function(){return draining},enqueue:function(cb){var i,tmp;if(size3===limit){tmp=draining;drain();draining=tmp}queue[(ix+size3)%limit]=cb;size3++;if(!draining){drain()}}}}();function Supervisor(util){var fibers={};var fiberId=0;var count=0;return{register:function(fiber){var fid=fiberId++;fiber.onComplete({rethrow:true,handler:function(result){return function(){count--;delete fibers[fid]}}})();fibers[fid]=fiber;count++},isEmpty:function(){return count===0},killAll:function(killError,cb){return function(){if(count===0){return cb()}var killCount=0;var kills={};function kill(fid){kills[fid]=fibers[fid].kill(killError,function(result){return function(){delete kills[fid];killCount--;if(util.isLeft(result)&&util.fromLeft(result)){setTimeout(function(){throw util.fromLeft(result)},0)}if(killCount===0){cb()}}})()}for(var k in fibers){if(fibers.hasOwnProperty(k)){killCount++;kill(k)}}fibers={};fiberId=0;count=0;return function(error3){return new Aff2(SYNC,function(){for(var k2 in kills){if(kills.hasOwnProperty(k2)){kills[k2]()}}})}}}}}var SUSPENDED=0;var CONTINUE=1;var STEP_BIND=2;var STEP_RESULT=3;var PENDING=4;var RETURN=5;var COMPLETED=6;function Fiber(util,supervisor,aff){var runTick=0;var status=SUSPENDED;var step2=aff;var fail=null;var interrupt=null;var bhead=null;var btail=null;var attempts=null;var bracketCount=0;var joinId=0;var joins=null;var rethrow=true;function run4(localRunTick){var tmp,result,attempt;while(true){tmp=null;result=null;attempt=null;switch(status){case STEP_BIND:status=CONTINUE;try{step2=bhead(step2);if(btail===null){bhead=null}else{bhead=btail._1;btail=btail._2}}catch(e){status=RETURN;fail=util.left(e);step2=null}break;case STEP_RESULT:if(util.isLeft(step2)){status=RETURN;fail=step2;step2=null}else if(bhead===null){status=RETURN}else{status=STEP_BIND;step2=util.fromRight(step2)}break;case CONTINUE:switch(step2.tag){case BIND:if(bhead){btail=new Aff2(CONS,bhead,btail)}bhead=step2._2;status=CONTINUE;step2=step2._1;break;case PURE:if(bhead===null){status=RETURN;step2=util.right(step2._1)}else{status=STEP_BIND;step2=step2._1}break;case SYNC:status=STEP_RESULT;step2=runSync(util.left,util.right,step2._1);break;case ASYNC:status=PENDING;step2=runAsync(util.left,step2._1,function(result2){return function(){if(runTick!==localRunTick){return}runTick++;Scheduler.enqueue(function(){if(runTick!==localRunTick+1){return}status=STEP_RESULT;step2=result2;run4(runTick)})}});return;case THROW:status=RETURN;fail=util.left(step2._1);step2=null;break;case CATCH:if(bhead===null){attempts=new Aff2(CONS,step2,attempts,interrupt)}else{attempts=new Aff2(CONS,step2,new Aff2(CONS,new Aff2(RESUME,bhead,btail),attempts,interrupt),interrupt)}bhead=null;btail=null;status=CONTINUE;step2=step2._1;break;case BRACKET:bracketCount++;if(bhead===null){attempts=new Aff2(CONS,step2,attempts,interrupt)}else{attempts=new Aff2(CONS,step2,new Aff2(CONS,new Aff2(RESUME,bhead,btail),attempts,interrupt),interrupt)}bhead=null;btail=null;status=CONTINUE;step2=step2._1;break;case FORK:status=STEP_RESULT;tmp=Fiber(util,supervisor,step2._2);if(supervisor){supervisor.register(tmp)}if(step2._1){tmp.run()}step2=util.right(tmp);break;case SEQ:status=CONTINUE;step2=sequential2(util,supervisor,step2._1);break}break;case RETURN:bhead=null;btail=null;if(attempts===null){status=COMPLETED;step2=interrupt||fail||step2}else{tmp=attempts._3;attempt=attempts._1;attempts=attempts._2;switch(attempt.tag){case CATCH:if(interrupt&&interrupt!==tmp&&bracketCount===0){status=RETURN}else if(fail){status=CONTINUE;step2=attempt._2(util.fromLeft(fail));fail=null}break;case RESUME:if(interrupt&&interrupt!==tmp&&bracketCount===0||fail){status=RETURN}else{bhead=attempt._1;btail=attempt._2;status=STEP_BIND;step2=util.fromRight(step2)}break;case BRACKET:bracketCount--;if(fail===null){result=util.fromRight(step2);attempts=new Aff2(CONS,new Aff2(RELEASE,attempt._2,result),attempts,tmp);if(interrupt===tmp||bracketCount>0){status=CONTINUE;step2=attempt._3(result)}}break;case RELEASE:attempts=new Aff2(CONS,new Aff2(FINALIZED,step2,fail),attempts,interrupt);status=CONTINUE;if(interrupt&&interrupt!==tmp&&bracketCount===0){step2=attempt._1.killed(util.fromLeft(interrupt))(attempt._2)}else if(fail){step2=attempt._1.failed(util.fromLeft(fail))(attempt._2)}else{step2=attempt._1.completed(util.fromRight(step2))(attempt._2)}fail=null;bracketCount++;break;case FINALIZER:bracketCount++;attempts=new Aff2(CONS,new Aff2(FINALIZED,step2,fail),attempts,interrupt);status=CONTINUE;step2=attempt._1;break;case FINALIZED:bracketCount--;status=RETURN;step2=attempt._1;fail=attempt._2;break}}break;case COMPLETED:for(var k in joins){if(joins.hasOwnProperty(k)){rethrow=rethrow&&joins[k].rethrow;runEff(joins[k].handler(step2))}}joins=null;if(interrupt&&fail){setTimeout(function(){throw util.fromLeft(fail)},0)}else if(util.isLeft(step2)&&rethrow){setTimeout(function(){if(rethrow){throw util.fromLeft(step2)}},0)}return;case SUSPENDED:status=CONTINUE;break;case PENDING:return}}}function onComplete(join3){return function(){if(status===COMPLETED){rethrow=rethrow&&join3.rethrow;join3.handler(step2)();return function(){}}var jid=joinId++;joins=joins||{};joins[jid]=join3;return function(){if(joins!==null){delete joins[jid]}}}}function kill(error3,cb){return function(){if(status===COMPLETED){cb(util.right(void 0))();return function(){}}var canceler=onComplete({rethrow:false,handler:function(){return cb(util.right(void 0))}})();switch(status){case SUSPENDED:interrupt=util.left(error3);status=COMPLETED;step2=interrupt;run4(runTick);break;case PENDING:if(interrupt===null){interrupt=util.left(error3)}if(bracketCount===0){if(status===PENDING){attempts=new Aff2(CONS,new Aff2(FINALIZER,step2(error3)),attempts,interrupt)}status=RETURN;step2=null;fail=null;run4(++runTick)}break;default:if(interrupt===null){interrupt=util.left(error3)}if(bracketCount===0){status=RETURN;step2=null;fail=null}}return canceler}}function join2(cb){return function(){var canceler=onComplete({rethrow:false,handler:cb})();if(status===SUSPENDED){run4(runTick)}return canceler}}return{kill:kill,join:join2,onComplete:onComplete,isSuspended:function(){return status===SUSPENDED},run:function(){if(status===SUSPENDED){if(!Scheduler.isDraining()){Scheduler.enqueue(function(){run4(runTick)})}else{run4(runTick)}}}}}function runPar(util,supervisor,par,cb){var fiberId=0;var fibers={};var killId=0;var kills={};var early=new Error("[ParAff] Early exit");var interrupt=null;var root=EMPTY;function kill(error3,par2,cb2){var step2=par2;var head3=null;var tail2=null;var count=0;var kills2={};var tmp,kid;loop:while(true){tmp=null;switch(step2.tag){case FORKED:if(step2._3===EMPTY){tmp=fibers[step2._1];kills2[count++]=tmp.kill(error3,function(result){return function(){count--;if(count===0){cb2(result)()}}})}if(head3===null){break loop}step2=head3._2;if(tail2===null){head3=null}else{head3=tail2._1;tail2=tail2._2}break;case MAP:step2=step2._2;break;case APPLY:case ALT:if(head3){tail2=new Aff2(CONS,head3,tail2)}head3=step2;step2=step2._1;break}}if(count===0){cb2(util.right(void 0))()}else{kid=0;tmp=count;for(;kid<tmp;kid++){kills2[kid]=kills2[kid]()}}return kills2}function join2(result,head3,tail2){var fail,step2,lhs,rhs,tmp,kid;if(util.isLeft(result)){fail=result;step2=null}else{step2=result;fail=null}loop:while(true){lhs=null;rhs=null;tmp=null;kid=null;if(interrupt!==null){return}if(head3===null){cb(fail||step2)();return}if(head3._3!==EMPTY){return}switch(head3.tag){case MAP:if(fail===null){head3._3=util.right(head3._1(util.fromRight(step2)));step2=head3._3}else{head3._3=fail}break;case APPLY:lhs=head3._1._3;rhs=head3._2._3;if(fail){head3._3=fail;tmp=true;kid=killId++;kills[kid]=kill(early,fail===lhs?head3._2:head3._1,function(){return function(){delete kills[kid];if(tmp){tmp=false}else if(tail2===null){join2(fail,null,null)}else{join2(fail,tail2._1,tail2._2)}}});if(tmp){tmp=false;return}}else if(lhs===EMPTY||rhs===EMPTY){return}else{step2=util.right(util.fromRight(lhs)(util.fromRight(rhs)));head3._3=step2}break;case ALT:lhs=head3._1._3;rhs=head3._2._3;if(lhs===EMPTY&&util.isLeft(rhs)||rhs===EMPTY&&util.isLeft(lhs)){return}if(lhs!==EMPTY&&util.isLeft(lhs)&&rhs!==EMPTY&&util.isLeft(rhs)){fail=step2===lhs?rhs:lhs;step2=null;head3._3=fail}else{head3._3=step2;tmp=true;kid=killId++;kills[kid]=kill(early,step2===lhs?head3._2:head3._1,function(){return function(){delete kills[kid];if(tmp){tmp=false}else if(tail2===null){join2(step2,null,null)}else{join2(step2,tail2._1,tail2._2)}}});if(tmp){tmp=false;return}}break}if(tail2===null){head3=null}else{head3=tail2._1;tail2=tail2._2}}}function resolve(fiber){return function(result){return function(){delete fibers[fiber._1];fiber._3=result;join2(result,fiber._2._1,fiber._2._2)}}}function run4(){var status=CONTINUE;var step2=par;var head3=null;var tail2=null;var tmp,fid;loop:while(true){tmp=null;fid=null;switch(status){case CONTINUE:switch(step2.tag){case MAP:if(head3){tail2=new Aff2(CONS,head3,tail2)}head3=new Aff2(MAP,step2._1,EMPTY,EMPTY);step2=step2._2;break;case APPLY:if(head3){tail2=new Aff2(CONS,head3,tail2)}head3=new Aff2(APPLY,EMPTY,step2._2,EMPTY);step2=step2._1;break;case ALT:if(head3){tail2=new Aff2(CONS,head3,tail2)}head3=new Aff2(ALT,EMPTY,step2._2,EMPTY);step2=step2._1;break;default:fid=fiberId++;status=RETURN;tmp=step2;step2=new Aff2(FORKED,fid,new Aff2(CONS,head3,tail2),EMPTY);tmp=Fiber(util,supervisor,tmp);tmp.onComplete({rethrow:false,handler:resolve(step2)})();fibers[fid]=tmp;if(supervisor){supervisor.register(tmp)}}break;case RETURN:if(head3===null){break loop}if(head3._1===EMPTY){head3._1=step2;status=CONTINUE;step2=head3._2;head3._2=EMPTY}else{head3._2=step2;step2=head3;if(tail2===null){head3=null}else{head3=tail2._1;tail2=tail2._2}}}}root=step2;for(fid=0;fid<fiberId;fid++){fibers[fid].run()}}function cancel(error3,cb2){interrupt=util.left(error3);var innerKills;for(var kid in kills){if(kills.hasOwnProperty(kid)){innerKills=kills[kid];for(kid in innerKills){if(innerKills.hasOwnProperty(kid)){innerKills[kid]()}}}}kills=null;var newKills=kill(error3,root,cb2);return function(killError){return new Aff2(ASYNC,function(killCb){return function(){for(var kid2 in newKills){if(newKills.hasOwnProperty(kid2)){newKills[kid2]()}}return nonCanceler}})}}run4();return function(killError){return new Aff2(ASYNC,function(killCb){return function(){return cancel(killError,killCb)}})}}function sequential2(util,supervisor,par){return new Aff2(ASYNC,function(cb){return function(){return runPar(util,supervisor,par,cb)}})}Aff2.EMPTY=EMPTY;Aff2.Pure=AffCtr(PURE);Aff2.Throw=AffCtr(THROW);Aff2.Catch=AffCtr(CATCH);Aff2.Sync=AffCtr(SYNC);Aff2.Async=AffCtr(ASYNC);Aff2.Bind=AffCtr(BIND);Aff2.Bracket=AffCtr(BRACKET);Aff2.Fork=AffCtr(FORK);Aff2.Seq=AffCtr(SEQ);Aff2.ParMap=AffCtr(MAP);Aff2.ParApply=AffCtr(APPLY);Aff2.ParAlt=AffCtr(ALT);Aff2.Fiber=Fiber;Aff2.Supervisor=Supervisor;Aff2.Scheduler=Scheduler;Aff2.nonCanceler=nonCanceler;return Aff2}();var _pure=Aff.Pure;var _throwError=Aff.Throw;function _catchError(aff){return function(k){return Aff.Catch(aff,k)}}function _map(f){return function(aff){if(aff.tag===Aff.Pure.tag){return Aff.Pure(f(aff._1))}else{return Aff.Bind(aff,function(value2){return Aff.Pure(f(value2))})}}}function _bind(aff){return function(k){return Aff.Bind(aff,k)}}var _liftEffect=Aff.Sync;var makeAff=Aff.Async;function _makeFiber(util,aff){return function(){return Aff.Fiber(util,null,aff)}}var _delay=function(){function setDelay(n,k){if(n===0&&typeof setImmediate!=="undefined"){return setImmediate(k)}else{return setTimeout(k,n)}}function clearDelay(n,t){if(n===0&&typeof clearImmediate!=="undefined"){return clearImmediate(t)}else{return clearTimeout(t)}}return function(right,ms){return Aff.Async(function(cb){return function(){var timer=setDelay(ms,cb(right()));return function(){return Aff.Sync(function(){return right(clearDelay(ms,timer))})}}})}}();var _sequential=Aff.Seq;function error(msg){return new Error(msg)}function message(e){return e.message}function throwException(e){return function(){throw e}}var $$throw=function($4){return throwException(error($4))};var catchError=function(dict){return dict.catchError};var $$try=function(dictMonadError){var catchError1=catchError(dictMonadError);var Monad0=dictMonadError.MonadThrow0().Monad0();var map6=map(Monad0.Bind1().Apply0().Functor0());var pure4=pure(Monad0.Applicative0());return function(a){return catchError1(map6(Right.create)(a))(function($52){return pure4(Left.create($52))})}};var liftEffect=function(dict){return dict.liftEffect};var _unsafePartial=function(f){return f()};var _crashWith=function(msg){throw new Error(msg)};var crashWith=function(){return _crashWith};var crashWith2=crashWith();var unsafePartial=_unsafePartial;var unsafeCrashWith=function(msg){return unsafePartial(function(){return crashWith2(msg)})};var $runtime_lazy3=function(name2,moduleName,init4){var state2=0;var val;return function(lineNumber){if(state2===2)return val;if(state2===1)throw new ReferenceError(name2+" was needed before it finished initializing (module "+moduleName+", line "+lineNumber+")",moduleName,lineNumber);state2=1;val=init4();state2=2;return val}};var $$void3=$$void(functorEffect);var functorAff={map:_map};var ffiUtil=function(){var unsafeFromRight=function(v){if(v instanceof Right){return v.value0}if(v instanceof Left){return unsafeCrashWith("unsafeFromRight: Left")}throw new Error("Failed pattern match at Effect.Aff (line 407, column 21 - line 409, column 54): "+[v.constructor.name])};var unsafeFromLeft=function(v){if(v instanceof Left){return v.value0}if(v instanceof Right){return unsafeCrashWith("unsafeFromLeft: Right")}throw new Error("Failed pattern match at Effect.Aff (line 402, column 20 - line 404, column 55): "+[v.constructor.name])};var isLeft=function(v){if(v instanceof Left){return true}if(v instanceof Right){return false}throw new Error("Failed pattern match at Effect.Aff (line 397, column 12 - line 399, column 21): "+[v.constructor.name])};return{isLeft:isLeft,fromLeft:unsafeFromLeft,fromRight:unsafeFromRight,left:Left.create,right:Right.create}}();var makeFiber=function(aff){return _makeFiber(ffiUtil,aff)};var launchAff=function(aff){return function __do(){var fiber=makeFiber(aff)();fiber.run();return fiber}};var monadAff={Applicative0:function(){return applicativeAff},Bind1:function(){return bindAff}};var bindAff={bind:_bind,Apply0:function(){return $lazy_applyAff(0)}};var applicativeAff={pure:_pure,Apply0:function(){return $lazy_applyAff(0)}};var $lazy_applyAff=$runtime_lazy3("applyAff","Effect.Aff",function(){return{apply:ap(monadAff),Functor0:function(){return functorAff}}});var bindFlipped2=bindFlipped(bindAff);var monadEffectAff={liftEffect:_liftEffect,Monad0:function(){return monadAff}};var liftEffect2=liftEffect(monadEffectAff);var monadThrowAff={throwError:_throwError,Monad0:function(){return monadAff}};var monadErrorAff={catchError:_catchError,MonadThrow0:function(){return monadThrowAff}};var $$try2=$$try(monadErrorAff);var runAff=function(k){return function(aff){return launchAff(bindFlipped2(function($77){return liftEffect2(k($77))})($$try2(aff)))}};var runAff_=function(k){return function(aff){return $$void3(runAff(k)(aff))}};var log=function(s){return function(){console.log(s)}};function querySelector_(selector){return document.querySelector(selector)}function createWindowListener_(eventName,updater){window.addEventListener(eventName,function(event){updater(event)()})}function createDocumentListener_(eventName,updater){document.addEventListener(eventName,function(event){updater(event)()})}function createCustomListener_(eventName,updater){document.addEventListener(eventName,function(event){updater(event.detail)()})}function nullable(a,r,f){return a==null?r:f(a)}var toMaybe=function(n){return nullable(n,Nothing.value,Just.create)};var runEffectFn1=function runEffectFn12(fn){return function(a){return function(){return fn(a)}}};var runEffectFn2=function runEffectFn22(fn){return function(a){return function(b){return function(){return fn(a,b)}}}};var runEffectFn4=function runEffectFn42(fn){return function(a){return function(b){return function(c){return function(d){return function(){return fn(a,b,c,d)}}}}}};var querySelector=function(selector){return function __do(){var selected=querySelector_(selector);return toMaybe(selected)}};var createWindowListener=runEffectFn2(createWindowListener_);var createDocumentListener=runEffectFn2(createDocumentListener_);var createCustomListener=runEffectFn2(createCustomListener_);var regexImpl=function(left){return function(right){return function(s1){return function(s2){try{return right(new RegExp(s1,s2))}catch(e){return left(e.message)}}}}};var _replaceBy=function(just){return function(nothing){return function(r){return function(f){return function(s){return s.replace(r,function(match){var groups=[];var group3,i=1;while(typeof(group3=arguments[i++])!=="number"){groups.push(group3==null?nothing:just(group3))}return f(match)(groups)})}}}}};var singleton4=function(c){return c};var length2=function(s){return s.length};var drop=function(n){return function(s){return s.substring(n)}};var charAt=function(i){return function(s){if(i>=0&&i<s.length)return s.charAt(i);throw new Error("Data.String.Unsafe.charAt: Invalid index.")}};var global={global:true,ignoreCase:false,multiline:false,dotAll:false,sticky:false,unicode:false};var replace$prime=function(){return _replaceBy(Just.create)(Nothing.value)}();var renderFlags=function(v){return function(){if(v.global){return"g"}return""}()+(function(){if(v.ignoreCase){return"i"}return""}()+(function(){if(v.multiline){return"m"}return""}()+(function(){if(v.dotAll){return"s"}return""}()+(function(){if(v.sticky){return"y"}return""}()+function(){if(v.unicode){return"u"}return""}()))))};var regex=function(s){return function(f){return regexImpl(Left.create)(Right.create)(s)(renderFlags(f))}};var classData=2;var propertyData=3;var attributeData=4;function createProperty_(name2){return function(value2){return[propertyData,name2,value2]}}function createAttribute_(name2){return function(value2){return[attributeData,name2,value2]}}function createClass(array){return[classData,array]}var hasArrayFrom=typeof Array.from==="function";var hasStringIterator=typeof Symbol!=="undefined"&&Symbol!=null&&typeof Symbol.iterator!=="undefined"&&typeof String.prototype[Symbol.iterator]==="function";var hasFromCodePoint=typeof String.prototype.fromCodePoint==="function";var hasCodePointAt=typeof String.prototype.codePointAt==="function";var _singleton=function(fallback){return hasFromCodePoint?String.fromCodePoint:fallback};function toCharCode(c){return c.charCodeAt(0)}function fromCharCode(c){return String.fromCharCode(c)}var top2=top(boundedInt);var bottom2=bottom(boundedInt);var toEnum=function(dict){return dict.toEnum};var fromEnum=function(dict){return dict.fromEnum};var toEnumWithDefaults=function(dictBoundedEnum){var toEnum1=toEnum(dictBoundedEnum);var fromEnum1=fromEnum(dictBoundedEnum);var bottom1=bottom(dictBoundedEnum.Bounded0());return function(low){return function(high){return function(x){var v=toEnum1(x);if(v instanceof Just){return v.value0}if(v instanceof Nothing){var $140=x<fromEnum1(bottom1);if($140){return low}return high}throw new Error("Failed pattern match at Data.Enum (line 158, column 33 - line 160, column 62): "+[v.constructor.name])}}}};var defaultSucc=function(toEnum$prime){return function(fromEnum$prime){return function(a){return toEnum$prime(fromEnum$prime(a)+1|0)}}};var defaultPred=function(toEnum$prime){return function(fromEnum$prime){return function(a){return toEnum$prime(fromEnum$prime(a)-1|0)}}};var charToEnum=function(v){if(v>=bottom2&&v<=top2){return new Just(fromCharCode(v))}return Nothing.value};var enumChar={succ:defaultSucc(charToEnum)(toCharCode),pred:defaultPred(charToEnum)(toCharCode),Ord0:function(){return ordChar}};var boundedEnumChar=function(){return{cardinality:toCharCode(top(boundedChar))-toCharCode(bottom(boundedChar))|0,toEnum:charToEnum,fromEnum:toCharCode,Bounded0:function(){return boundedChar},Enum1:function(){return enumChar}}}();var fromEnum2=fromEnum(boundedEnumChar);var div2=div(euclideanRingInt);var mod2=mod(euclideanRingInt);var unsurrogate=function(lead){return function(trail){return(((lead-55296|0)*1024|0)+(trail-56320|0)|0)+65536|0}};var isTrail=function(cu){return 56320<=cu&&cu<=57343};var isLead=function(cu){return 55296<=cu&&cu<=56319};var uncons=function(s){var v=length2(s);if(v===0){return Nothing.value}if(v===1){return new Just({head:fromEnum2(charAt(0)(s)),tail:""})}var cu1=fromEnum2(charAt(1)(s));var cu0=fromEnum2(charAt(0)(s));var $42=isLead(cu0)&&isTrail(cu1);if($42){return new Just({head:unsurrogate(cu0)(cu1),tail:drop(2)(s)})}return new Just({head:cu0,tail:drop(1)(s)})};var fromCharCode2=function(){var $74=toEnumWithDefaults(boundedEnumChar)(bottom(boundedChar))(top(boundedChar));return function($75){return singleton4($74($75))}}();var singletonFallback=function(v){if(v<=65535){return fromCharCode2(v)}var lead=div2(v-65536|0)(1024)+55296|0;var trail=mod2(v-65536|0)(1024)+56320|0;return fromCharCode2(lead)+fromCharCode2(trail)};var singleton5=_singleton(singletonFallback);function toArrayWithKey(f){return function(m){var r=[];for(var k in m){if(hasOwnProperty.call(m,k)){r.push(f(k)(m[k]))}}return r}}var keys=Object.keys||toArrayWithKey(function(k){return function(){return k}});var fromJust2=fromJust();var crashWith3=crashWith();var show2=show(showString);var map2=map(functorArray);var to=function(dict){return dict.to};var stringClassList={to:function(){var $41=filter(function(){var $44=not(heytingAlgebraBoolean);return function($45){return $44($$null($45))}}());var $42=split(" ");return function($43){return $41($42($43))}}()};var createProperty=function(name1){return function(value1){return createProperty_(name1)(value1)}};var id=createProperty("id");var src=createProperty("src");var type$prime=createProperty("type");var value=createProperty("value");var createAttribute=function(name1){return function(value1){return createAttribute_(name1)(value1)}};var $$for=createAttribute("for");var caseify=function(name$prime){if(name$prime===toUpper(name$prime)){return toLower(name$prime)}if(otherwise){var v=fromJust2(uncons(name$prime));var replacer=function($128){return $$const(function(v1){return"-"+v1}(toLower($128)))};var regex2=function(){var v1=regex("[A-Z]")(global);if(v1 instanceof Right){return v1.value0}if(v1 instanceof Left){return crashWith3(show2(v1.value0))}throw new Error("Failed pattern match at Flame.Html.Attribute.Internal (line 98, column 38 - line 100, column 56): "+[v1.constructor.name])}();var hyphenated=replace$prime(regex2)(replacer)(v.tail);return toLower(singleton5(v.head))+hyphenated}throw new Error("Failed pattern match at Flame.Html.Attribute.Internal (line 92, column 1 - line 92, column 28): "+[name$prime.constructor.name])};var class$prime=function(dictToClassList){var $129=map2(caseify);var $130=to(dictToClassList);return function($131){return createClass($129($130($131)))}};var textNode=1;var elementNode=2;var svgNode=3;var styleData=1;var classData2=2;var propertyData2=3;var attributeData2=4;var keyData=7;function createElementNode(tag){return function(nodeData){return function(potentialChildren){let children=potentialChildren,text2=void 0;if(potentialChildren.length===1&&potentialChildren[0].nodeType==textNode){children=void 0;text2=potentialChildren[0].text}return{nodeType:elementNode,node:void 0,tag:tag,nodeData:fromNodeData(nodeData),children:children,text:text2}}}}function createDatalessElementNode(tag){return function(potentialChildren){let children=potentialChildren,text2=void 0;if(potentialChildren.length===1&&potentialChildren[0].nodeType==textNode){children=void 0;text2=potentialChildren[0].text}return{nodeType:elementNode,node:void 0,tag:tag,nodeData:{},children:children,text:text2}}}function createSingleElementNode(tag){return function(nodeData){return{nodeType:elementNode,node:void 0,tag:tag,nodeData:fromNodeData(nodeData)}}}function createEmptyElement(tag){return{nodeType:tag.trim().toLowerCase()==="svg"?svgNode:elementNode,node:void 0,tag:tag,nodeData:{}}}function text(value2){return{nodeType:textNode,node:void 0,text:value2}}function fromNodeData(allData){let nodeData={};if(allData!==void 0)for(let data of allData){let dataOne=data[1];switch(data[0]){case styleData:if(nodeData.styles===void 0)nodeData.styles={};for(let key in dataOne)nodeData.styles[key]=dataOne[key];break;case classData2:if(nodeData.classes===void 0)nodeData.classes=[];nodeData.classes=nodeData.classes.concat(dataOne);break;case propertyData2:if(nodeData.properties===void 0)nodeData.properties={};nodeData.properties[dataOne]=data[2];break;case attributeData2:if(nodeData.attributes===void 0)nodeData.attributes={};nodeData.attributes[dataOne]=data[2];break;case keyData:nodeData.key=dataOne;break;default:if(nodeData.events===void 0)nodeData.events={};if(nodeData.events[dataOne]===void 0)nodeData.events[dataOne]=[];nodeData.events[dataOne].push(data[2])}}return nodeData}var toNode=function(dict){return dict.toNode};var nodeDataToNodedata={toNode:singleton2};var htmlToHtml={toNode:singleton2};var createElement_=function(tag){return function(dictToNode){var toNode1=toNode(dictToNode);return function(children){return createDatalessElementNode(tag)(toNode1(children))}}};var div_=function(dictToNode){return createElement_("div")(dictToNode)};var createElement$prime=function(tag){return function(dictToNode){var toNode1=toNode(dictToNode);return function(nodeData){return createSingleElementNode(tag)(toNode1(nodeData))}}};var img=function(dictToNode){return createElement$prime("img")(dictToNode)};var input=function(dictToNode){return createElement$prime("input")(dictToNode)};var createElement=function(tag){return function(dictToNode){var toNode1=toNode(dictToNode);return function(dictToNode1){var toNode2=toNode(dictToNode1);return function(nodeData){return function(children){return createElementNode(tag)(toNode1(nodeData))(toNode2(children))}}}}};var div3=function(dictToNode){return function(dictToNode1){return createElement("div")(dictToNode)(dictToNode1)}};var label=function(dictToNode){return function(dictToNode1){return createElement("label")(dictToNode)(dictToNode1)}};var pre=function(dictToNode){return function(dictToNode1){return createElement("pre")(dictToNode)(dictToNode1)}};var br=createEmptyElement("br");var arrayToNodeData=function(dictToNode){return{toNode:concatMap(toNode(dictToNode))}};var reUnescapedHtml=/[&<>"']/g;var reHasUnescapedHtml=RegExp(reUnescapedHtml.source);var traverse1Impl=function(){function Cont(fn){this.fn=fn}var emptyList={};var ConsCell=function(head3,tail2){this.head=head3;this.tail=tail2};function finalCell(head3){return new ConsCell(head3,emptyList)}function consList(x){return function(xs){return new ConsCell(x,xs)}}function listToArray(list){var arr=[];var xs=list;while(xs!==emptyList){arr.push(xs.head);xs=xs.tail}return arr}return function(apply2){return function(map6){return function(f){var buildFrom=function(x,ys){return apply2(map6(consList)(f(x)))(ys)};var go=function(acc,currentLen,xs){if(currentLen===0){return acc}else{var last3=xs[currentLen-1];return new Cont(function(){var built=go(buildFrom(last3,acc),currentLen-1,xs);return built})}};return function(array){var acc=map6(finalCell)(f(array[array.length-1]));var result=go(acc,array.length-1,array);while(result instanceof Cont){result=result.fn()}return map6(listToArray)(result)}}}}}();function compareReference_(a){return function(b){return a===b}}var compareReference=function(a){return function(a2){return compareReference_(a)(a2)}};var modelHasChanged=function(old){return function($$new2){return!compareReference(old)($$new2)}};var namespace="http://www.w3.org/2000/svg";var eventPrefix="__flame_";var eventPostfix="updater";var textNode2=1;var elementNode2=2;var svgNode2=3;var fragmentNode=4;var lazyNode=5;var managedNode=6;var nonBubblingEvents=["focus","blur","scroll"];function start_(eventWrapper,root,updater,html){return new F(eventWrapper,root,updater,html,false)}function startFrom_(eventWrapper,root,updater,html){return new F(eventWrapper,root,updater,html,true)}function resume_(f,html){f.resume(html)}function F(eventWrapper,root,updater,html,isDry){this.eventWrapper=eventWrapper;this.applicationEvents=new Map;this.root=root;this.updater=updater;this.cachedHtml=html.node===void 0?html:shallowCopy(html);if(isDry)this.hydrate(this.root,this.cachedHtml);else this.createAllNodes(this.root,this.cachedHtml)}F.prototype.hydrate=function(parent,html,referenceNode){switch(html.nodeType){case lazyNode:html.node=parent;html.rendered=html.render(html.arg);html.render=void 0;this.hydrate(parent,html.rendered);break;case textNode2:html.node=parent;break;case managedNode:this.createAllNodes(parent,html,referenceNode);break;default:if(html.nodeType===fragmentNode)html.node=document.createDocumentFragment();else{html.node=parent;if(html.nodeData.events!==void 0)this.createAllEvents(parent,html)}let htmlChildrenLength;if(html.text===void 0&&html.children!==void 0&&(htmlChildrenLength=html.children.length)>0){let childNodes=parent.childNodes;for(let i=0,cni=0;i<htmlChildrenLength;++i,++cni){let c=html.children[i]=html.children[i].node===void 0?html.children[i]:shallowCopy(html.children[i]);if(childNodes[cni]===void 0)this.createAllNodes(parent,c);else{if(c.nodeType===fragmentNode){let fragmentChildrenLength=c.children.length;c.node=document.createDocumentFragment();for(let j=0;j<fragmentChildrenLength;++j){let cf=c.children[j]=c.children[j].node===void 0?c.children[j]:shallowCopy(c.children[j]);this.hydrate(childNodes[cni++],cf)}cni--}else if(c.nodeType===managedNode)this.hydrate(parent,c,childNodes[cni]);else this.hydrate(childNodes[cni],c)}}}}};function shallowCopy(origin){switch(origin.nodeType){case textNode2:return{nodeType:textNode2,node:void 0,text:origin.text};case fragmentNode:return{nodeType:fragmentNode,node:void 0,children:origin.children};case lazyNode:return{nodeType:lazyNode,node:void 0,nodeData:origin.nodeData,render:origin.render,arg:origin.arg,rendered:void 0,messageMapper:origin.messageMapper};case managedNode:return{nodeType:managedNode,node:void 0,nodeData:origin.nodeData,createNode:origin.createNode,updateNode:origin.updateNode,arg:origin.arg,messageMapper:origin.messageMapper};default:return{nodeType:origin.nodeType,node:void 0,tag:origin.tag,nodeData:origin.nodeData,children:origin.children,text:origin.text,messageMapper:origin.messageMapper}}}F.prototype.createAllNodes=function(parent,html,referenceNode){let node=this.createNode(html);if(html.text!==void 0)node.textContent=html.text;else{if(html.children!==void 0)this.createChildrenNodes(node,html.children);else if(html.rendered!==void 0){if(html.messageMapper!==void 0)lazyMessageMap(html.messageMapper,html.rendered);if(html.rendered.text!==void 0){node.textContent=html.rendered.text}else if(html.rendered.children!==void 0)this.createChildrenNodes(node,html.rendered.children)}}parent.insertBefore(node,referenceNode)};F.prototype.checkCreateAllNodes=function(parent,html,referenceNode){if(html.node!==void 0)html=shallowCopy(html);this.createAllNodes(parent,html,referenceNode);return html};F.prototype.createChildrenNodes=function(parent,children){let childrenLength=children.length;for(let i=0;i<childrenLength;++i){let c=children[i]=children[i].node===void 0?children[i]:shallowCopy(children[i]),node=this.createNode(c);if(c.text!==void 0)node.textContent=c.text;else{if(c.children!==void 0)this.createChildrenNodes(node,c.children);else if(c.rendered!==void 0){if(c.messageMapper!==void 0)lazyMessageMap(c.messageMapper,c.rendered);if(c.rendered.children!==void 0)this.createChildrenNodes(node,c.rendered.children)}}parent.appendChild(node)}};F.prototype.createNode=function(html){switch(html.nodeType){case lazyNode:html.rendered=html.render(html.arg);html.render=void 0;return html.node=this.createNode(html.rendered);case textNode2:return html.node=document.createTextNode(html.text);case elementNode2:return html.node=this.createElement(html);case svgNode2:return html.node=this.createSvg(html);case fragmentNode:return html.node=document.createDocumentFragment();case managedNode:return html.node=this.createManagedNode(html)}};F.prototype.createElement=function(html){let element=document.createElement(html.tag);this.createNodeData(element,html,false);return element};F.prototype.createSvg=function(html){let svg=document.createElementNS(namespace,html.tag);this.createNodeData(svg,html,true);return svg};F.prototype.createManagedNode=function(html){let node=html.createNode(html.arg)();html.createNode=void 0;this.createNodeData(node,html,node instanceof SVGElement||node.nodeName.toLowerCase()==="svg");return node};F.prototype.createNodeData=function(node,html,isSvg){if(html.nodeData.styles!==void 0)createStyles(node,html.nodeData.styles);if(html.nodeData.classes!==void 0&&html.nodeData.classes.length>0)createClasses(node,html.nodeData.classes,isSvg);if(html.nodeData.attributes!==void 0)createAttributes(node,html.nodeData.attributes);if(html.nodeData.properties!==void 0)for(let key in html.nodeData.properties)node[key]=html.nodeData.properties[key];if(html.nodeData.events!==void 0)this.createAllEvents(node,html)};function createStyles(node,styles){for(let key in styles)node.style.setProperty(key,styles[key])}function createClasses(node,classes,isSvg){let joined=classes.join(" ");if(isSvg)node.setAttribute("class",joined);else node.className=joined}function createAttributes(node,attributes){for(let key in attributes)node.setAttribute(key,attributes[key])}F.prototype.createAllEvents=function(node,html){for(let key in html.nodeData.events)this.createEvent(node,key,html)};F.prototype.createEvent=function(node,name2,html){let handlers=html.nodeData.events[name2],eventKey=eventPrefix+name2;if(nonBubblingEvents.includes(name2)){let runNonBubblingEvent=this.runNonBubblingEvent(handlers,html.messageMapper);node[eventKey]=runNonBubblingEvent;node.addEventListener(name2,runNonBubblingEvent,false)}else{node[eventKey]=handlers;if(html.messageMapper!==void 0)node[eventKey+eventPostfix]=html.messageMapper;let synthethic=this.applicationEvents.get(name2);if(synthethic===void 0){let runEvent=this.runEvent.bind(this);this.root.addEventListener(name2,runEvent,false);this.applicationEvents.set(name2,{count:1,handler:runEvent})}else synthethic.count++}};F.prototype.runNonBubblingEvent=function(handlers,messageMapper2){return function(event){this.runHandlers(handlers,messageMapper2,event)}.bind(this)};F.prototype.runEvent=function(event){let node=event.target,eventKey=eventPrefix+event.type;while(node!==this.root){let handlers=node[eventKey];if(handlers!==void 0){this.runHandlers(handlers,node[eventKey+eventPostfix],event);return}node=node.parentNode}};F.prototype.runHandlers=function(handlers,messageMapper2,event){let handlersLength=handlers.length;for(let i=0;i<handlersLength;++i){let h=handlers[i],maybeMessage=typeof h==="function"?h(event)():this.eventWrapper(h);this.updater(messageMapper2===void 0?maybeMessage:messageMapper2(maybeMessage))()}event.stopPropagation()};F.prototype.resume=function(updatedHtml){this.cachedHtml=this.updateAllNodes(this.root,this.cachedHtml,updatedHtml)};F.prototype.updateAllNodes=function(parent,currentHtml2,updatedHtml){if(updatedHtml.node!==void 0)updatedHtml=shallowCopy(updatedHtml);if(currentHtml2.tag!==updatedHtml.tag||currentHtml2.nodeType!==updatedHtml.nodeType){this.createAllNodes(parent,updatedHtml,currentHtml2.node);parent.removeChild(currentHtml2.node)}else{updatedHtml.node=currentHtml2.node;switch(updatedHtml.nodeType){case lazyNode:if(updatedHtml.arg!==currentHtml2.arg){updatedHtml.rendered=updatedHtml.render(updatedHtml.arg);if(updatedHtml.messageMapper!==void 0)lazyMessageMap(updatedHtml.messageMapper,updatedHtml.rendered);this.updateAllNodes(parent,currentHtml2.rendered,updatedHtml.rendered)}else updatedHtml.rendered=currentHtml2.rendered;updatedHtml.render=void 0;break;case managedNode:let node=updatedHtml.updateNode(currentHtml2.node)(currentHtml2.arg)(updatedHtml.arg)(),isSvg=node instanceof SVGElement||node.nodeName.toLowerCase()==="svg";if(node!==currentHtml2.node||node.nodeType!==currentHtml2.node.nodeType||node.nodeName!==currentHtml2.node.nodeName){this.createNodeData(node,updatedHtml,isSvg);parent.insertBefore(node,currentHtml2.node);parent.removeChild(currentHtml2.node)}else this.updateNodeData(node,currentHtml2.nodeData,updatedHtml,isSvg);updatedHtml.node=node;break;case textNode2:if(updatedHtml.text!==currentHtml2.text)updatedHtml.node.textContent=updatedHtml.text;break;case fragmentNode:this.updateChildrenNodes(parent,currentHtml2,updatedHtml);break;default:this.updateNodeData(currentHtml2.node,currentHtml2.nodeData,updatedHtml,updatedHtml.nodeType==svgNode2);if((updatedHtml.text!==void 0||updatedHtml.children===void 0&&currentHtml2.text!=void 0)&&!hasInnerHtml(updatedHtml.nodeData)&&updatedHtml.text!=currentHtml2.node.textContent)currentHtml2.node.textContent=updatedHtml.text;else this.updateChildrenNodes(currentHtml2.node,currentHtml2,updatedHtml)}}return updatedHtml};function clearNode(node){node.textContent=""}F.prototype.updateChildrenNodes=function(parent,currentHtml2,updatedHtml){let currentChildren=currentHtml2.children,updatedChildren=updatedHtml.children;if(currentChildren===void 0||currentChildren.length===0){let updatedChildrenLength;if(updatedChildren!==void 0&&(updatedChildrenLength=updatedChildren.length)>0){if(currentHtml2.text!==void 0||hasInnerHtml(currentHtml2.nodeData))clearNode(parent);for(let i=0;i<updatedChildrenLength;++i)updatedChildren[i]=this.checkCreateAllNodes(parent,updatedChildren[i])}}else if(updatedChildren===void 0||updatedChildren.length===0){if(currentChildren!==void 0&&(currentChildren.length>0||currentHtml2.text!==void 0)&&!hasInnerHtml(updatedHtml.nodeData))clearNode(parent)}else if(currentChildren[0].nodeData!==void 0&&currentChildren[0].nodeData.key!==void 0&&updatedChildren[0].nodeData!==void 0&&updatedChildren[0].nodeData.key!==void 0)this.updateKeyedChildrenNodes(parent,currentChildren,updatedChildren);else this.updateNonKeyedChildrenNodes(parent,currentChildren,updatedChildren)};function hasInnerHtml(parentNodeData){return parentNodeData!==void 0&&parentNodeData.properties!==void 0&&parentNodeData.properties.innerHTML!==void 0}F.prototype.updateKeyedChildrenNodes=function(parent,currentChildren,updatedChildren){let currentStart=0,updatedStart=0,currentEnd=currentChildren.length-1,updatedEnd=updatedChildren.length-1;let afterNode,currentStartNode=currentChildren[currentStart].node,updatedStartNode=currentStartNode,currentEndNode=currentChildren[currentEnd].node;let loop=true;fixes:while(loop){loop=false;let currentHtml2=currentChildren[currentStart],updatedHtml=updatedChildren[updatedStart];while(currentHtml2.nodeData.key===updatedHtml.nodeData.key){updatedHtml=this.updateAllNodes(parent,currentHtml2,updatedHtml);updatedStartNode=currentStartNode=currentHtml2.node.nextSibling;currentStart++;updatedStart++;if(currentEnd<currentStart||updatedEnd<updatedStart)break fixes;currentHtml2=currentChildren[currentStart];updatedHtml=updatedChildren[updatedStart]}currentHtml2=currentChildren[currentEnd];updatedHtml=updatedChildren[updatedEnd];while(currentHtml2.nodeData.key===updatedHtml.nodeData.key){updatedHtml=this.updateAllNodes(parent,currentHtml2,updatedHtml);afterNode=currentEndNode;currentEndNode=currentEndNode.previousSibling;currentEnd--;updatedEnd--;if(currentEnd<currentStart||updatedEnd<updatedStart)break fixes;currentHtml2=currentChildren[currentEnd];updatedHtml=updatedChildren[updatedEnd]}currentHtml2=currentChildren[currentEnd];updatedHtml=updatedChildren[updatedStart];while(currentHtml2.nodeData.key===updatedHtml.nodeData.key){loop=true;updatedHtml=this.updateAllNodes(parent,currentHtml2,updatedHtml);currentEndNode=currentHtml2.node.previousSibling;parent.insertBefore(currentHtml2.node,updatedStartNode);updatedStart++;currentEnd--;if(currentEnd<currentStart||updatedEnd<updatedStart)break fixes;currentHtml2=currentChildren[currentEnd];updatedHtml=updatedChildren[updatedStart]}currentHtml2=currentChildren[currentStart];updatedHtml=updatedChildren[updatedEnd];while(currentHtml2.nodeData.key===updatedHtml.nodeData.key){loop=true;updatedHtml=this.updateAllNodes(parent,currentHtml2,updatedHtml);parent.insertBefore(currentHtml2.node,afterNode);afterNode=currentHtml2.node;currentStart++;updatedEnd--;if(currentEnd<currentStart||updatedEnd<updatedStart)break fixes;currentHtml2=currentChildren[currentStart];updatedHtml=updatedChildren[updatedEnd]}}if(updatedEnd<updatedStart)while(currentStart<=currentEnd){parent.removeChild(currentChildren[currentEnd].node);currentEnd--}else if(currentEnd<currentStart)while(updatedStart<=updatedEnd){updatedChildren[updatedStart]=this.checkCreateAllNodes(parent,updatedChildren[updatedStart],afterNode);updatedStart++}else{let P=new Int32Array(updatedEnd+1-updatedStart);let I=new Map;for(let i=updatedStart;i<=updatedEnd;i++){P[i]=-1;I.set(updatedChildren[i].nodeData.key,i)}let reusingNodes=updatedStart+updatedChildren.length-1-updatedEnd,toRemove=[];for(let i=currentStart;i<=currentEnd;i++)if(I.has(currentChildren[i].nodeData.key)){P[I.get(currentChildren[i].nodeData.key)]=i;reusingNodes++}else toRemove.push(i);if(reusingNodes===0){parent.textContent="";for(let i=updatedStart;i<=updatedEnd;i++)updatedChildren[i]=this.checkCreateAllNodes(parent,updatedChildren[i])}else{let toRemoveLength=toRemove.length;for(let i=0;i<toRemoveLength;i++)parent.removeChild(currentChildren[toRemove[i]].node);let longestSeq=longestSubsequence(P,updatedStart),seqIndex=longestSeq.length-1;for(let i=updatedEnd;i>=updatedStart;i--){if(longestSeq[seqIndex]===i){currentHtml=currentChildren[P[longestSeq[seqIndex]]];updatedChildren[i]=this.updateAllNodes(parent,currentHtml,updatedChildren[i]);afterNode=currentHtml.node;seqIndex--}else{if(P[i]===-1){updatedChildren[i]=this.checkCreateAllNodes(parent,updatedChildren[i],afterNode);afterNode=updatedChildren[i].node}else{currentHtml=currentChildren[P[i]];updatedChildren[i]=this.updateAllNodes(parent,currentHtml,updatedChildren[i]);parent.insertBefore(currentHtml.node,afterNode);afterNode=currentHtml.node}}}}}};function longestSubsequence(ns,updatedStart){let seq=[],is=[],l=-1,i,len,pre3=new Int32Array(ns.length);for(i=updatedStart,len=ns.length;i<len;i++){let n=ns[i];if(n<0)continue;let j=findGreatestIndex(seq,n);if(j!==-1)pre3[i]=is[j];if(j===l){l++;seq[l]=n;is[l]=i}else if(n<seq[j+1]){seq[j+1]=n;is[j+1]=i}}for(i=is[l];l>=0;i=pre3[i],l--)seq[l]=i;return seq}function findGreatestIndex(seq,n){let lo=-1,hi=seq.length;if(hi>0&&seq[hi-1]<=n)return hi-1;while(hi-lo>1){let mid=Math.floor((lo+hi)/2);if(seq[mid]>n)hi=mid;else lo=mid}return lo}F.prototype.updateNonKeyedChildrenNodes=function(parent,currentChildren,updatedChildren){let currentChildrenLength=currentChildren.length,updatedChildrenLength=updatedChildren.length,commonLength=Math.min(currentChildrenLength,updatedChildrenLength);for(let i=0;i<commonLength;++i)updatedChildren[i]=this.updateAllNodes(parent,currentChildren[i],updatedChildren[i]);if(currentChildrenLength<updatedChildrenLength)for(let i=commonLength;i<updatedChildrenLength;++i)updatedChildren[i]=this.checkCreateAllNodes(parent,updatedChildren[i]);else if(currentChildrenLength>updatedChildrenLength)for(let i=commonLength;i<currentChildrenLength;++i)parent.removeChild(currentChildren[i].node)};F.prototype.updateNodeData=function(node,currentNodeData,updatedHtml,isSvg){updateStyles(node,currentNodeData.styles,updatedHtml.nodeData.styles);updateAttributes(node,currentNodeData.attributes,updatedHtml.nodeData.attributes);updateClasses(node,currentNodeData.classes,updatedHtml.nodeData.classes,isSvg);updateProperties(node,currentNodeData.properties,updatedHtml.nodeData.properties);this.updateEvents(node,currentNodeData.events,updatedHtml)};function updateStyles(node,currentStyles,updatedStyles){if(currentStyles===void 0){if(updatedStyles!==void 0)createStyles(node,updatedStyles)}else if(updatedStyles===void 0){if(currentStyles!==void 0)node.removeAttribute("style")}else{let matchCount=0;for(let key in currentStyles){let current=currentStyles[key],updated=updatedStyles[key],hasUpdated=updatedStyles[key]!==void 0;if(hasUpdated)matchCount++;if(current!==updated)if(hasUpdated)node.style.setProperty(key,updated);else node.style.removeProperty(key)}let newKeys=Object.keys(updatedStyles),newKeysLength=newKeys.length;for(let i=0;matchCount<newKeysLength&&i<newKeysLength;++i){let key=newKeys[i];if(currentStyles[key]===void 0){let updated=updatedStyles[key];++matchCount;node.style.setProperty(key,updated)}}}}function updateClasses(node,currentClasses,updatedClasses,isSvg){let classUpdated=updatedClasses!==void 0&&updatedClasses.length>0;if(currentClasses!==void 0&&currentClasses.length>0&&!classUpdated)createClasses(node,[],isSvg);else if(classUpdated)createClasses(node,updatedClasses,isSvg)}function updateAttributes(node,currentAttributes,updatedAttributes){if(currentAttributes===void 0){if(updatedAttributes!==void 0)createAttributes(node,updatedAttributes)}else if(updatedAttributes===void 0){if(currentAttributes!==void 0)for(let key in currentAttributes)node.removeAttribute(key)}else{let matchCount=0;for(let key in currentAttributes){let current=currentAttributes[key],updated=updatedAttributes[key],hasUpdated=updated!==void 0;if(hasUpdated)matchCount++;if(current!==updated)if(hasUpdated)node.setAttribute(key,updated);else node.removeAttribute(key)}let newKeys=Object.keys(updatedAttributes),newKeysLength=newKeys.length;for(let i=0;matchCount<newKeysLength&&i<newKeysLength;++i){let key=newKeys[i];if(currentAttributes[key]===void 0){let updated=updatedAttributes[key];++matchCount;node.setAttribute(key,updated)}}}}function updateProperties(node,currentProperties,updatedProperties){let addAll=currentProperties===void 0,removeAll=updatedProperties===void 0;if(addAll){if(!removeAll)for(let key in updatedProperties)node[key]=updatedProperties[key]}else if(removeAll){if(!addAll)for(let key in currentProperties)node.removeAttribute(key)}else{let matchCount=0;for(let key in currentProperties){let current=currentProperties[key],updated=updatedProperties[key],hasUpdated=updated!==void 0;if(hasUpdated)matchCount++;if(current!==updated)if(hasUpdated)node[key]=updated;else node.removeAttribute(key)}let newKeys=Object.keys(updatedProperties),newKeysLength=newKeys.length;for(let i=0;matchCount<newKeysLength&&i<newKeysLength;++i){let key=newKeys[i];if(currentProperties[key]===void 0){let updated=updatedProperties[key];++matchCount;node[key]=updated}}}}F.prototype.updateEvents=function(node,currentEvents,updatedHtml){let updatedEvents=updatedHtml.nodeData.events;if(currentEvents===void 0){if(updatedEvents!==void 0)this.createAllEvents(node,updatedHtml)}else if(updatedEvents===void 0){if(currentEvents!==void 0)for(let key in currentEvents)this.removeEvent(node,key)}else{let matchCount=0;for(let key in currentEvents){let current=currentEvents[key],updated=updatedEvents[key],hasUpdated=false;if(updated===void 0)this.removeEvent(node,key);else{let currentLength=current.length,updatedLength=updated.length;if(currentLength!=updatedLength)hasUpdated=true;else{for(let i=0;i<currentLength;++i)if(current[i]!=updated[i]){hasUpdated=true;break}}}if(hasUpdated){matchCount++;this.removeEvent(node,key);this.createEvent(node,key,updatedHtml)}}let newKeys=Object.keys(updatedEvents),newKeysLength=newKeys.length;for(let i=0;matchCount<newKeysLength&&i<newKeysLength;++i){let key=newKeys[i];if(currentEvents[key]===void 0){++matchCount;this.createEvent(node,key,updatedHtml)}}}};F.prototype.removeEvent=function(node,name2){let eventKey=eventPrefix+name2;if(nonBubblingEvents.includes(name2)){let runNonBubblingEvent=node[eventKey];node.removeEventListener(name2,runNonBubblingEvent,false)}else{let count=--this.applicationEvents.get(name2).count;if(count===0){this.root.removeEventListener(name2,this.applicationEvents.get(name2).handler,false);this.applicationEvents.delete(name2)}}node[eventKey+eventPostfix]=void 0;node[eventKey]=void 0};function lazyMessageMap(mapper,html){html.messageMapper=mapper;if(html.children!==void 0&&html.children.length>0)for(let i=0;i<html.children.length;++i)lazyMessageMap(mapper,html.children[i])}var pure2=pure(applicativeEffect);var resume=runEffectFn2(resume_);var maybeUpdater=function(updater){return function(v){if(v instanceof Just){return updater(v.value0)}return pure2(unit)}};var start=function(parent){return function(updater){return runEffectFn4(start_)(Just.create)(parent)(maybeUpdater(updater))}};var startFrom=function(parent){return function(updater){return runEffectFn4(startFrom_)(Just.create)(parent)(maybeUpdater(updater))}};var applicationIds=new Set;function checkApplicationId_(id3){if(applicationIds.has(id3))throw`Error mounting application: id ${id3} already registered!`;applicationIds.add(id3)}var Window=function(){function Window2(){}Window2.value=new Window2;return Window2}();var Document=function(){function Document2(){}Document2.value=new Document2;return Document2}();var Custom=function(){function Custom2(){}Custom2.value=new Custom2;return Custom2}();var isArray=Array.isArray||function(value2){return Object.prototype.toString.call(value2)==="[object Array]"};var unsafeFromForeign=unsafeCoerce2;var createSubscription=function(updater){return function(v){if(v.value0 instanceof Window){return createWindowListener(v.value1.value0)(function($13){return updater(v.value1.value1.value0($13))})}if(v.value0 instanceof Document){return createDocumentListener(v.value1.value0)(function($14){return updater(v.value1.value1.value0($14))})}if(v.value0 instanceof Custom){return createCustomListener(v.value1.value0)(function($15){return updater(v.value1.value1.value0($15))})}throw new Error("Failed pattern match at Flame.Subscription.Internal.Listener (line 31, column 83 - line 34, column 76): "+[v.value0.constructor.name])}};var checkApplicationId=runEffectFn1(checkApplicationId_);var createMessageListener=function(appId){return function(updater){return function __do(){checkApplicationId(appId)();return createCustomListener(appId)(function($16){return updater(unsafeFromForeign($16))})()}}};var when2=when(applicativeEffect);var for_2=for_(applicativeEffect)(foldableArray);var pure3=pure(applicativeEffect);var traverse_2=traverse_(applicativeEffect)(foldableArray);var map3=map(functorMaybe);var showId=function(dictShow){var show3=show(dictShow);return function(v){return show3(v)}};var run3=function(parent){return function(isResumed){return function(appId){return function(v){return function __do(){var modelState=$$new(v.init.value0)();var renderingState=$$new(21)();var render3=function(model){return function __do2(){var rendering2=read(renderingState)();resume(rendering2)(v.view(model))();return write(model)(modelState)()}};var runUpdate=function(message2){return function __do2(){var currentModel=read(modelState)();var v1=v.update(currentModel)(message2);when2(modelHasChanged(currentModel)(v1.value0))(render3(v1.value0))();return runMessages(v1.value1)()}};var runMessages=function(affs){return for_2(affs)(runAff_(function(v1){if(v1 instanceof Left){return log(message(v1.value0))}if(v1 instanceof Right&&v1.value0 instanceof Just){return runUpdate(v1.value0.value0)}return pure3(unit)}))};var rendering=function(){if(isResumed){return startFrom(parent)(runUpdate)(v.view(v.init.value0))()}return start(parent)(runUpdate)(v.view(v.init.value0))()}();write(rendering)(renderingState)();runMessages(v.init.value1)();(function(){if(appId instanceof Nothing){return unit}if(appId instanceof Just){return createMessageListener(appId.value0)(runUpdate)()}throw new Error("Failed pattern match at Flame.Application.EffectList (line 142, column 7 - line 144, column 63): "+[appId.constructor.name])})();return traverse_2(createSubscription(runUpdate))(v.subscribe)()}}}}};var noAppId=function(){return Nothing.value}();var mountWith=function(dictShow){var showId1=showId(dictShow);return function(v){return function(appId){return function(application2){return function __do(){var maybeElement=querySelector(v)();if(maybeElement instanceof Just){return run3(maybeElement.value0)(false)(map3(showId1)(appId))(application2)()}if(maybeElement instanceof Nothing){return $$throw("Error mounting application")()}throw new Error("Failed pattern match at Flame.Application.EffectList (line 102, column 7 - line 104, column 63): "+[maybeElement.constructor.name])}}}}};var mountWith1=mountWith(showUnit);var mount_=function(selector){return mountWith1(selector)(noAppId)};var rawEventData=6;function createRawEvent_(name2){return function(handler){return[rawEventData,name2,handler]}}function nodeValue_(event){if(event.target.contentEditable===true||event.target.contentEditable==="true"||event.target.contentEditable==="")return event.target.innerText;return event.target.value}var map4=map(functorEffect);var nodeValue=runEffectFn1(nodeValue_);var createRawEvent=function(name2){return function(handler){return createRawEvent_(name2)(handler)}};var onInput=function(constructor){var handler=function(event){return map4(function($6){return Just.create(constructor($6))})(nodeValue(event))};return createRawEvent("input")(handler)};var mempty2=mempty(monoidArray);var arrayToNodeData2=arrayToNodeData(nodeDataToNodedata);var arrayToNodeData1=arrayToNodeData(htmlToHtml);var div4=div3(arrayToNodeData2)(arrayToNodeData1);var class$prime2=class$prime(stringClassList);var map5=map(functorArray);var img2=img(arrayToNodeData2);var fromFoldable6=fromFoldable(foldableList);var unwrap2=unwrap();var mempty1=mempty(monoidString);var fold3=fold2(monoidString);var eq13=eq(eqList(eqList(eqString)));var fromFoldable1=fromFoldable2(foldableArray);var append1=append(semigroupList);var wrap2=wrap();var div_2=div_(arrayToNodeData1);var label2=label(arrayToNodeData2)(arrayToNodeData1);var input2=input(arrayToNodeData2);var pre2=pre(arrayToNodeData2)(arrayToNodeData1);var EmojiNameChanged=function(){function EmojiNameChanged2(value0){this.value0=value0}EmojiNameChanged2.create=function(value0){return new EmojiNameChanged2(value0)};return EmojiNameChanged2}();var PlaceholderNameChanged=function(){function PlaceholderNameChanged2(value0){this.value0=value0}PlaceholderNameChanged2.create=function(value0){return new PlaceholderNameChanged2(value0)};return PlaceholderNameChanged2}();var ContentChanged=function(){function ContentChanged2(value0){this.value0=value0}ContentChanged2.create=function(value0){return new ContentChanged2(value0)};return ContentChanged2}();var DisplayCharacter=function(x){return x};var update=function(model){return function(v){if(v instanceof EmojiNameChanged){return new Tuple({emojiName:v.value0,content:model.content,placeholderName:model.placeholderName},mempty2)}if(v instanceof PlaceholderNameChanged){return new Tuple({placeholderName:v.value0,content:model.content,emojiName:model.emojiName},mempty2)}if(v instanceof ContentChanged){return new Tuple({content:toUpper(v.value0),emojiName:model.emojiName,placeholderName:model.placeholderName},mempty2)}throw new Error("Failed pattern match at Main (line 98, column 1 - line 98, column 64): "+[model.constructor.name,v.constructor.name])}};var renderView=function(v){return function(v1){var renderRow=function(columns){return div4([class$prime2("flex")])(map5(function(col){var $60=col===v.emojiName;if($60){return img2([class$prime2("flex-shrink-0 ma0 pa0 bn w1.5 h1.5 bg-transparent"),src("im_square.gif")])}return img2([class$prime2("flex-shrink-0 ma0 pa0 bn w1.5 h1.5 bg-transparent")])})(fromFoldable6(columns)))};return div4([class$prime2("flex flex-column items-center")])(map5(renderRow)(fromFoldable6(v1)))}};var newline="\n";var renderText=function(v){var renderRow=function(v1){if(v1 instanceof Cons){return":"+(v1.value0+(":"+renderRow(v1.value1)))}if(v1 instanceof Nil){return mempty1}throw new Error("Failed pattern match at Main (line 72, column 3 - line 72, column 37): "+[v1.constructor.name])};return fold3(intersperse(newline)(map5(renderRow)(fromFoldable6(v))))};var inputLabelClass="black-70 f5 dib mb1";var inputClass="pa2 black-80 br2 b--blue outline-light-blue b--solid avenir f5";var init3=function(){return new Tuple({emojiName:"awesome-face",placeholderName:"blank",content:"cool"},mempty2)}();var eqDisplayCharacter={eq:function(x){return function(y){return eq13(x)(y)}}};var eq2=eq(eqDisplayCharacter);var asDisplayCharacter=function(){var $85=map5(fromFoldable1);return function($86){return DisplayCharacter(fromFoldable1($85($86)))}}();var semigroupDisplayCharacter={append:function(v){return function(v1){if(v instanceof Cons&&v1 instanceof Cons){return new Cons(append1(v.value0)(v1.value0),unwrap2(append(semigroupDisplayCharacter)(v.value1)(v1.value1)))}return mempty(monoidDisplayCharacter)}}};var monoidDisplayCharacter={mempty:asDisplayCharacter([[],[],[],[],[]]),Semigroup0:function(){return semigroupDisplayCharacter}};var mempty22=mempty(monoidDisplayCharacter);var append2=append(semigroupDisplayCharacter);var characterMatrix=function(v){return function(v1){return function(v2){if(v2==="A"){return asDisplayCharacter([[v1,v,v1],[v,v1,v],[v,v,v],[v,v1,v],[v,v1,v]])}if(v2==="B"){return asDisplayCharacter([[v,v,v1],[v,v1,v],[v,v,v],[v,v1,v],[v,v,v1]])}if(v2==="C"){return asDisplayCharacter([[v,v,v],[v,v1,v1],[v,v1,v1],[v,v1,v1],[v,v,v]])}if(v2==="D"){return asDisplayCharacter([[v,v,v1],[v,v1,v],[v,v1,v],[v,v1,v],[v,v,v1]])}if(v2==="E"){return asDisplayCharacter([[v,v,v],[v,v1,v1],[v,v,v],[v,v1,v1],[v,v,v]])}if(v2==="F"){return asDisplayCharacter([[v,v,v],[v,v1,v1],[v,v,v],[v,v1,v1],[v,v1,v1]])}if(v2==="G"){return asDisplayCharacter([[v,v,v],[v,v1,v1],[v,v1,v],[v,v1,v],[v,v,v]])}if(v2==="H"){return asDisplayCharacter([[v,v1,v],[v,v1,v],[v,v,v],[v,v1,v],[v,v1,v]])}if(v2==="I"){return asDisplayCharacter([[v],[v],[v],[v],[v]])}if(v2==="J"){return asDisplayCharacter([[v1,v1,v],[v1,v1,v],[v1,v1,v],[v,v1,v],[v1,v,v1]])}if(v2==="K"){return asDisplayCharacter([[v,v1,v],[v,v1,v],[v,v,v1],[v,v1,v],[v,v1,v]])}if(v2==="L"){return asDisplayCharacter([[v,v1,v1],[v,v1,v1],[v,v1,v1],[v,v1,v1],[v,v,v]])}if(v2==="M"){return asDisplayCharacter([[v,v1,v],[v,v,v],[v,v1,v],[v,v1,v],[v,v1,v]])}if(v2==="N"){return asDisplayCharacter([[v,v,v],[v,v1,v],[v,v1,v],[v,v1,v],[v,v1,v]])}if(v2==="O"){return asDisplayCharacter([[v,v,v],[v,v1,v],[v,v1,v],[v,v1,v],[v,v,v]])}if(v2==="P"){return asDisplayCharacter([[v,v,v],[v,v1,v],[v,v,v],[v,v1,v1],[v,v1,v1]])}if(v2==="Q"){return asDisplayCharacter([[v,v,v],[v,v1,v],[v,v1,v],[v,v,v],[v1,v1,v]])}if(v2==="R"){return asDisplayCharacter([[v,v,v],[v,v1,v],[v,v,v1],[v,v,v1],[v,v1,v]])}if(v2==="S"){return asDisplayCharacter([[v,v,v],[v,v1,v1],[v,v,v],[v1,v1,v],[v,v,v]])}if(v2==="T"){return asDisplayCharacter([[v,v,v],[v1,v,v1],[v1,v,v1],[v1,v,v1],[v1,v,v1]])}if(v2==="U"){return asDisplayCharacter([[v,v1,v],[v,v1,v],[v,v1,v],[v,v1,v],[v,v,v]])}if(v2==="V"){return asDisplayCharacter([[v,v1,v],[v,v1,v],[v,v1,v],[v1,v,v1],[v1,v,v1]])}if(v2==="W"){return asDisplayCharacter([[v,v1,v],[v,v1,v],[v,v1,v],[v,v,v],[v,v1,v]])}if(v2==="X"){return asDisplayCharacter([[v,v1,v],[v1,v,v1],[v1,v,v1],[v1,v,v1],[v,v1,v]])}if(v2==="Y"){return asDisplayCharacter([[v,v1,v],[v1,v,v1],[v1,v,v1],[v1,v,v1],[v1,v,v1]])}if(v2==="Z"){return asDisplayCharacter([[v,v,v],[v1,v1,v],[v1,v,v1],[v,v1,v1],[v,v,v]])}if(v2===" "){return asDisplayCharacter([[v1],[v1],[v1],[v1],[v1]])}return mempty22}}};var render2=function(v){return foldl2(function(acc){return function(cur){var $78=eq2(cur)(characterMatrix(v.emojiName)(v.placeholderName)(" "));if($78){return append2(acc)(cur)}return append2(acc)(append2(cur)(characterMatrix(v.emojiName)(v.placeholderName)(" ")))}})(mempty22)(map5(characterMatrix(v.emojiName)(v.placeholderName))(split(wrap2(""))(v.content)))};var view=function(model){return div4([class$prime2("pa3 avenir")])([div4([class$prime2("flex flex-column items-center")])([div_2([label2([class$prime2(inputLabelClass),$$for("emoji-name")])([text("Emoji Name")]),br,input2([type$prime("text"),class$prime2(inputClass),id("emoji-name"),value(model.emojiName),onInput(EmojiNameChanged.create)])]),div4([class$prime2("mt3")])([label2([class$prime2(inputLabelClass),$$for("placeholder-name")])([text("Placeholder Name")]),br,input2([type$prime("text"),class$prime2(inputClass),id("placeholder-name"),value(model.placeholderName),onInput(PlaceholderNameChanged.create)])]),div4([class$prime2("mt3")])([label2([class$prime2(inputLabelClass),$$for("content")])([text("Content")]),br,input2([type$prime("text"),class$prime2(inputClass),id("content"),value(model.content),onInput(ContentChanged.create)])])]),function(){var displayObject=render2(model);return div_2([div4([class$prime2("mt3")])([renderView(model)(displayObject)]),div4([class$prime2("mt3")])([pre2([class$prime2("center measure-wide overflow-x-auto courier db")])([text(renderText(displayObject))])])])}()])};var application={view:view,subscribe:mempty2,init:init3,update:update};var main=mount_(wrap2("#app"))(application);main()})();